# PostgreSQL (CNPG) - Zero-Touch Provisioning

## Quick Start

Create a PostgresInstance claim - that's it:

```yaml
apiVersion: database.bizmatters.io/v1alpha1
kind: PostgresInstance
metadata:
  name: my-service-db
  namespace: my-namespace
spec:
  size: medium    # small, medium, large
  version: "16"
  storageGB: 20
```

## What Happens Automatically

1. CNPG Cluster created with auto-generated password
2. Database and owner auto-derived from claim name: `my-service-db` → `my_service_db`
3. Connection secret `my-service-db-conn` created in your namespace

## Connection Secret

Secret `{claim-name}-conn` contains:

| Key | Value |
|-----|-------|
| `endpoint` | `{name}-rw.{namespace}.svc.cluster.local` |
| `port` | `5432` |
| `database` | Auto-derived from claim name |
| `username` | Auto-derived from claim name |
| `password` | Auto-generated by CNPG |

## Application Usage

```yaml
env:
  - name: POSTGRES_HOST
    valueFrom:
      secretKeyRef:
        name: my-service-db-conn
        key: endpoint
  - name: POSTGRES_PASSWORD
    valueFrom:
      secretKeyRef:
        name: my-service-db-conn
        key: password
```

## Size Options

| Size | Memory | CPU |
|------|--------|-----|
| small | 256Mi-1Gi | 250m-1000m |
| medium | 512Mi-2Gi | 500m-2000m |
| large | 1Gi-4Gi | 1000m-4000m |

## Zero-Touch Flow

```
You commit claim → Crossplane creates CNPG → CNPG generates password
                                          → Crossplane copies to {name}-conn secret
                                          → Your app reads from secret
```

No SSM. No ExternalSecrets. No manual passwords.
